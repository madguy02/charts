
<style>
form {
    line-height: 2em;
}
/*p {
    margin: 5px 0;
} */
h2 {
    margin: 10px 0;
    font-size: 1.2em;
    font-weight: bold
}
#result {
    margin: 10px;
    background: #eee;
    padding: 10px;
    height: 40px;
    overflow: auto;
}
.button {
    background-color: #4CAF50; /* Green */
    border: none;
    color: white;
    padding: 15px 32px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
}


</style>


<script src="https://code.jquery.com/jquery-3.1.1.min.js"
        integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
        crossorigin="anonymous"></script>
    

<body bgcolor = "grey">
<h2><strong><center>TECHNOFOUR CONTROL PANEL</center></strong></h2>
<br></br>
<form action="" method="post">
<strong>Voltage:</strong><input type="text" name="voltage" maxlength="12" size="12"/> <br/>
<br></br>
<strong>gain value:</strong><input type="text" name="gain_value" maxlength="36" size="12"/> <br/>

<br></br>
<strong>peak window size:</strong><input type="text" name="peak_window_size" value=""/><br/>
<br></br>
<strong>measurement type:</strong><input type="text" name="measurement_type" value=""/><br/>

<br></br>
<strong>Probe frequency:</strong><input type="text" name="probe_frequency" value=""/><br/>
<br></br>
<strong>Probe type:</strong><input type="text" name="probe_type" value=""/><br/>
<br></br>
<button><input type="submit"></button>
</form>
<h2>Message sent to server</h2> 
<pre id="result"> 
</pre>

<script>
  //var socket = io('http://localhost');
  $.fn.serializeObject = function()
 {
    var o = {};
    var a = this.serializeArray();
    $.each(a, function() {
         if (o[this.name] !== undefined) {
             if (!o[this.name].push) {
                o[this.name] = [o[this.name]];
             }
            o[this.name].push(this.value || '');
         } else {
             o[this.name] = this.value || '';
        }
     });

    return o;
 };


(function (window) {
  window.onload = function () {
    var ws = new WebSocket("ws://localhost:8080/echo1");
    var temp = {};
    //temp['voltage'] = document.querySelector("input[name='voltage']").value;
   // temp['gain_value'] = document.querySelector("input[name='gain_value']").value;
   // temp['peak_window_size'] = document.querySelector("input[name='peak_window_size']").value;
    //temp['measurement_type'] = document.querySelector("input[name='measurement_type']").value;
    //temp['probe_frequency'] = document.querySelector("input[name='probe_frequency']").value;
    document.querySelector("button input[type='submit']").onclick = function (evt) {

    temp['voltage'] = document.querySelector("input[name='voltage']").value;
    temp['gain_value'] = document.querySelector("input[name='gain_value']").value;
    temp['peak_window_size'] = document.querySelector("input[name='peak_window_size']").value;
    temp['measurement_type'] = document.querySelector("input[name='measurement_type']").value;
    temp['probe_frequency'] = document.querySelector("input[name='probe_frequency']").value;
    temp['probe_type'] = document.querySelector("input[name='probe_type']").value;
    
      ws.send(JSON.stringify(temp));//.serializeObject()));
    
    };

    ws.onmessage = function (evt) {
      //ws.broadcast(message: "Hello remote server, please broadcast my message to all the connected users.");
      var server_message = evt.data;
      //ws.send(evt.data);      
     //console.log("Received from server:"+server_message);
      console.log(server_message);

      if (server_message== ""){
        console.log ("Server started!!");
      }
      if (server_message == evt.data) {
        console.log("data");
      };
      //ws.send(evt.data);
      //alert("data posted to server side is displayed down ");
      //ar JsonObject = JSON.parse(evt.data);
      //console.log(evt.data + "hello server i am a client,i received the data back so chill");
      //console.log(JsonObject);
     
    };

    //ws.onmessage = function (evt) {
      //var client_message = evt.data;
        //console.log(client_message);
    //};


    ws.onopen = function (evt) {
      //var open_message = evt.data;
      //console.log(open_message);
      alert("connection opened ");
    };
  };
  window.onclose = function () {
    alert("connections are being closed");
  };
})(window);

 $(function() {
    $('form').submit(function() {
       $('#result').text(JSON.stringify($('form').serializeObject()));
        return false;

    });
});



</script>